Code is not thread safe

not 100% test coverage. I would prefer tdd approach but due to time constraints need to change the approach
